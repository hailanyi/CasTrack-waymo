# 3D MOT on Waymo dataset
This project is developed for online 3D multi-object tracking on Waymo dataset. It is build upon CasA
 detector and CA-based KF tracker. The tracking code
 is from [here](https://github.com/hailanyi/3D-Multi-Object-Tracker); detector is from [here](https://github.com/hailanyi/CasA); visualization code is from
[here](https://github.com/hailanyi/3D-Detection-Tracking-Viewer).
![](./doc/demo.gif)

## Waymo Results
**Vehicle/Pedestrian/Cyclist** online tracking results, evaluated by **MOTA/L2** metrics of Waymo benchmark. 

* 2022/9/23  Update [CasTrack-waymo](https://github.com/hailanyi/CasTrack-waymo), currently **ranks third** on Waymo tracking benchmark :fire:! 

|set|Vehicle_L2|Pedestrian_L2|Cyclist_L2| ALL_NS_L2 |
|:---:|:---:|:---:|:---:|:---:|
|val set|59.30|62.78|61.72|61.27|
|test set|63.66|64.79|59.34|62.60|
 
## Prepare data 
 You can download the CasA detections from [here](https://drive.google.com/file/d/1xDTXrKf3azvW0m6e3xMV1PluICRDstPk/view?usp=sharing)
(Please register with waymo before downloading, as the Waymo open dataset is under strict non-commercial license). To run this code, you need prepare the waymo dataset
infos generated by [CasA](https://github.com/hailanyi/CasA).

## Quick start
* Please modify the info path, detections path in the [yaml file](./config/config.yaml) 
to your own path.
* Then run ``` python3 waymo_tracking.py config/config.yaml``` 
* The results are automatically saved to ```save_path``` in yaml file, and 
evaluated by Waymo metrics (the results are lower than the one calculated by Waymo benchmark).
You can create a submission file to evaluate the performance on Waymo benchmark by running ``` python3 create_submission/create_submission.py```


